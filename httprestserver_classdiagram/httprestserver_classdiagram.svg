<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1108px" preserveAspectRatio="none" style="width:1738px;height:1108px;" version="1.1" viewBox="0 0 1738 1108" width="1738px" zoomAndPan="magnify"><defs><filter height="300%" id="f14cyf4wa1gl9m" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[d621a1cf36efacd102423184f657d5e8]
class BaseHTTPServer--><rect codeLine="1" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="176.0469" id="BaseHTTPServer" style="stroke: #A80036; stroke-width: 1.5;" width="368" x="865.5" y="128"/><ellipse cx="994.25" cy="144" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M997.2188,149.6406 Q996.6406,149.9375 996,150.0781 Q995.3594,150.2344 994.6563,150.2344 Q992.1563,150.2344 990.8281,148.5938 Q989.5156,146.9375 989.5156,143.8125 Q989.5156,140.6875 990.8281,139.0313 Q992.1563,137.375 994.6563,137.375 Q995.3594,137.375 996,137.5313 Q996.6563,137.6875 997.2188,137.9844 L997.2188,140.7031 Q996.5938,140.125 996,139.8594 Q995.4063,139.5781 994.7813,139.5781 Q993.4375,139.5781 992.75,140.6563 Q992.0625,141.7188 992.0625,143.8125 Q992.0625,145.9063 992.75,146.9844 Q993.4375,148.0469 994.7813,148.0469 Q995.4063,148.0469 996,147.7813 Q996.5938,147.5 997.2188,146.9219 L997.2188,149.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="102" x="1014.75" y="148.1543">BaseHTTPServer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="866.5" x2="1232.5" y1="160" y2="160"/><ellipse cx="876.5" cy="171" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="885.5" y="174.2104">const string VERSION</text><ellipse cx="876.5" cy="183.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="885.5" y="187.0151">const string NAME</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="873.5" y="193.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="41" x="885.5" y="199.8198">int port</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="873.5" y="206.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="885.5" y="212.6245">bool running</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="873.5" y="219.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="885.5" y="225.4292">TcpListener listener</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="873.5" y="232.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="342" x="885.5" y="238.2339">List&lt;IResourceEndpointHandler&gt; resourceEndpointHandlers</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="866.5" x2="1232.5" y1="244.8281" y2="244.8281"/><ellipse cx="876.5" cy="255.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="885.5" y="259.0386">BaseHTTPServer(int port)</text><ellipse cx="876.5" cy="268.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="885.5" y="271.8433">void Start()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="873.5" y="278.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="885.5" y="284.6479">void Run()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="873.5" y="291.2422"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="885.5" y="297.4526">void HandleClient(TcpClient client)</text><!--MD5=[496b068da06cd131afb585115329e858]
class IHTTPServer--><rect codeLine="90" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="60.8047" id="IHTTPServer" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="996.5" y="7"/><ellipse cx="1011.5" cy="23" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1007.4219,18.7656 L1007.4219,16.6094 L1014.8125,16.6094 L1014.8125,18.7656 L1012.3438,18.7656 L1012.3438,26.8438 L1014.8125,26.8438 L1014.8125,29 L1007.4219,29 L1007.4219,26.8438 L1009.8906,26.8438 L1009.8906,18.7656 L1007.4219,18.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="74" x="1025.5" y="27.1543">IHTTPServer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="997.5" x2="1101.5" y1="39" y2="39"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="997.5" x2="1101.5" y1="47" y2="47"/><ellipse cx="1007.5" cy="58" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="1016.5" y="61.2104">void Start()</text><!--MD5=[68efced5630f6877a792fbf4b1d46ff2]
class RequestContext--><rect codeLine="15" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="163.2422" id="RequestContext" style="stroke: #A80036; stroke-width: 1.5;" width="357" x="7" y="708"/><ellipse cx="131.25" cy="724" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M134.2188,729.6406 Q133.6406,729.9375 133,730.0781 Q132.3594,730.2344 131.6563,730.2344 Q129.1563,730.2344 127.8281,728.5938 Q126.5156,726.9375 126.5156,723.8125 Q126.5156,720.6875 127.8281,719.0313 Q129.1563,717.375 131.6563,717.375 Q132.3594,717.375 133,717.5313 Q133.6563,717.6875 134.2188,717.9844 L134.2188,720.7031 Q133.5938,720.125 133,719.8594 Q132.4063,719.5781 131.7813,719.5781 Q130.4375,719.5781 129.75,720.6563 Q129.0625,721.7188 129.0625,723.8125 Q129.0625,725.9063 129.75,726.9844 Q130.4375,728.0469 131.7813,728.0469 Q132.4063,728.0469 133,727.7813 Q133.5938,727.5 134.2188,726.9219 L134.2188,729.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="100" x="151.75" y="728.1543">RequestContext</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="8" x2="363" y1="740" y2="740"/><ellipse cx="18" cy="751" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="27" y="754.2104">String Type {get;set;}</text><ellipse cx="18" cy="763.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="27" y="767.0151">String URL {get;set;}</text><ellipse cx="18" cy="776.6094" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="27" y="779.8198">String HTTPVersion {get;set;}</text><ellipse cx="18" cy="789.4141" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="303" x="27" y="792.6245">List&lt;HttpHeaderPair&gt; HeaderPairs {get;private set;}</text><ellipse cx="18" cy="802.2188" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="128" x="27" y="805.4292">String Body {get;set;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="8" x2="363" y1="812.0234" y2="812.0234"/><ellipse cx="18" cy="823.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="27" y="826.2339">void AddHeader(String headerLine)</text><ellipse cx="18" cy="835.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="313" x="27" y="839.0386">static RequestContext GetBaseRequest(String request)</text><ellipse cx="18" cy="848.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="27" y="851.8433">override string ToString()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="15" y="858.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="331" x="27" y="864.6479">RequestContext(String type, String url, String httpVersion)</text><!--MD5=[677561f5d4a6bdd391d5d93a52324b49]
class HttpHeaderPair--><rect codeLine="28" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="99.2188" id="HttpHeaderPair" style="stroke: #A80036; stroke-width: 1.5;" width="335" x="18" y="963"/><ellipse cx="132.75" cy="979" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M135.7188,984.6406 Q135.1406,984.9375 134.5,985.0781 Q133.8594,985.2344 133.1563,985.2344 Q130.6563,985.2344 129.3281,983.5938 Q128.0156,981.9375 128.0156,978.8125 Q128.0156,975.6875 129.3281,974.0313 Q130.6563,972.375 133.1563,972.375 Q133.8594,972.375 134.5,972.5313 Q135.1563,972.6875 135.7188,972.9844 L135.7188,975.7031 Q135.0938,975.125 134.5,974.8594 Q133.9063,974.5781 133.2813,974.5781 Q131.9375,974.5781 131.25,975.6563 Q130.5625,976.7188 130.5625,978.8125 Q130.5625,980.9063 131.25,981.9844 Q131.9375,983.0469 133.2813,983.0469 Q133.9063,983.0469 134.5,982.7813 Q135.0938,982.5 135.7188,981.9219 L135.7188,984.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="153.25" y="983.1543">HttpHeaderPair</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="19" x2="352" y1="995" y2="995"/><ellipse cx="29" cy="1006" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="38" y="1009.2104">String HeaderKey {get;set;}</text><ellipse cx="29" cy="1018.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="38" y="1022.0151">String HeaderValue {get;set;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="19" x2="352" y1="1028.6094" y2="1028.6094"/><ellipse cx="29" cy="1039.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="38" y="1042.8198">HttpHeaderPair(String headerKey, String headerValue)</text><ellipse cx="29" cy="1052.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="38" y="1055.6245">override string ToString()</text><!--MD5=[b937ea1e5ddaf966c75792a5554ec602]
class IResourceEndpointHandler--><rect codeLine="36" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="73.6094" id="IResourceEndpointHandler" style="stroke: #A80036; stroke-width: 1.5;" width="354" x="872.5" y="383"/><ellipse cx="961.75" cy="399" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M957.6719,394.7656 L957.6719,392.6094 L965.0625,392.6094 L965.0625,394.7656 L962.5938,394.7656 L962.5938,402.8438 L965.0625,402.8438 L965.0625,405 L957.6719,405 L957.6719,402.8438 L960.1406,402.8438 L960.1406,394.7656 L957.6719,394.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="167" x="982.25" y="403.1543">IResourceEndpointHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="873.5" x2="1225.5" y1="415" y2="415"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="873.5" x2="1225.5" y1="423" y2="423"/><ellipse cx="883.5" cy="434" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="328" x="892.5" y="437.2104">bool CheckResponsibility(RequestContext requestContext)</text><ellipse cx="883.5" cy="446.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="892.5" y="450.0151">void HandleRequest(RequestContext requestContext)</text><!--MD5=[69aa3d4358c8cfb7789bd1ad26a563d6]
class ICRUDHandler--><rect codeLine="41" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="112.0234" id="ICRUDHandler" style="stroke: #A80036; stroke-width: 1.5;" width="325" x="513" y="364"/><ellipse cx="627.75" cy="380" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M623.6719,375.7656 L623.6719,373.6094 L631.0625,373.6094 L631.0625,375.7656 L628.5938,375.7656 L628.5938,383.8438 L631.0625,383.8438 L631.0625,386 L623.6719,386 L623.6719,383.8438 L626.1406,383.8438 L626.1406,375.7656 L623.6719,375.7656 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="87" x="648.25" y="384.1543">ICRUDHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="514" x2="837" y1="396" y2="396"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="514" x2="837" y1="404" y2="404"/><ellipse cx="524" cy="415" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="279" x="533" y="418.2104">void ListHandler(RequestContext requestContext)</text><ellipse cx="524" cy="427.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="297" x="533" y="431.0151">void CreateHandler(RequestContext requestContext)</text><ellipse cx="524" cy="440.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="287" x="533" y="443.8198">void ReadHandler(RequestContext requestContext)</text><ellipse cx="524" cy="453.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="299" x="533" y="456.6245">void UpdateHandler(RequestContext requestContext)</text><ellipse cx="524" cy="466.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="295" x="533" y="469.4292">void DeleteHandler(RequestContext requestContext)</text><!--MD5=[a376f80f529380c08341def9a9715ac8]
class MessageResourceEndpointHandler--><rect codeLine="49" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="112.0234" id="MessageResourceEndpointHandler" style="stroke: #A80036; stroke-width: 1.5;" width="409" x="658" y="536"/><ellipse cx="748.25" cy="552" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M751.2188,557.6406 Q750.6406,557.9375 750,558.0781 Q749.3594,558.2344 748.6563,558.2344 Q746.1563,558.2344 744.8281,556.5938 Q743.5156,554.9375 743.5156,551.8125 Q743.5156,548.6875 744.8281,547.0313 Q746.1563,545.375 748.6563,545.375 Q749.3594,545.375 750,545.5313 Q750.6563,545.6875 751.2188,545.9844 L751.2188,548.7031 Q750.5938,548.125 750,547.8594 Q749.4063,547.5781 748.7813,547.5781 Q747.4375,547.5781 746.75,548.6563 Q746.0625,549.7188 746.0625,551.8125 Q746.0625,553.9063 746.75,554.9844 Q747.4375,556.0469 748.7813,556.0469 Q749.4063,556.0469 750,555.7813 Q750.5938,555.5 751.2188,554.9219 L751.2188,557.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="220" x="768.75" y="556.1543">MessageResourceEndpointHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="1066" y1="568" y2="568"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="666" y="576"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="678" y="582.2104">List&lt;Message&gt; messages</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="666" y="588.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="678" y="595.0151">const String urlBase</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="666" y="601.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="181" x="678" y="607.8198">List&lt;RouteAction&gt; RouteActions</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="1066" y1="614.4141" y2="614.4141"/><ellipse cx="669" cy="625.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="205" x="678" y="628.6245">MessageResourceEndpointHandler()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="666" y="635.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="383" x="678" y="641.4292">RouteAction DetermineRouteAction(RequestContext requestContext)</text><!--MD5=[72658dde7d7c1527ffbf8d5904233397]
class RouteAction--><rect codeLine="57" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="99.2188" id="RouteAction" style="stroke: #A80036; stroke-width: 1.5;" width="529" x="399" y="740"/><ellipse cx="621.25" cy="756" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M624.2188,761.6406 Q623.6406,761.9375 623,762.0781 Q622.3594,762.2344 621.6563,762.2344 Q619.1563,762.2344 617.8281,760.5938 Q616.5156,758.9375 616.5156,755.8125 Q616.5156,752.6875 617.8281,751.0313 Q619.1563,749.375 621.6563,749.375 Q622.3594,749.375 623,749.5313 Q623.6563,749.6875 624.2188,749.9844 L624.2188,752.7031 Q623.5938,752.125 623,751.8594 Q622.4063,751.5781 621.7813,751.5781 Q620.4375,751.5781 619.75,752.6563 Q619.0625,753.7188 619.0625,755.8125 Q619.0625,757.9063 619.75,758.9844 Q620.4375,760.0469 621.7813,760.0469 Q622.4063,760.0469 623,759.7813 Q623.5938,759.5 624.2188,758.9219 L624.2188,761.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="641.75" y="760.1543">RouteAction</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="400" x2="927" y1="772" y2="772"/><ellipse cx="410" cy="783" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="419" y="786.2104">String PathRegex {get;set;}</text><ellipse cx="410" cy="795.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="266" x="419" y="799.0151">Action&lt;RequestContext&gt; PathAction {get;set;}</text><ellipse cx="410" cy="808.6094" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="173" x="419" y="811.8198">String RequestType {get;set;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="400" x2="927" y1="818.4141" y2="818.4141"/><ellipse cx="410" cy="829.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="503" x="419" y="832.6245">RouteAction(IAction&lt;RequestContext&gt; pathAction, String pathRegex, String requestType)</text><!--MD5=[bea5b0d46523efab5ea1c1d339f396f0]
class Message--><rect codeLine="65" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="86.4141" id="Message" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="963.5" y="746.5"/><ellipse cx="1030.25" cy="762.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1033.2188,768.1406 Q1032.6406,768.4375 1032,768.5781 Q1031.3594,768.7344 1030.6563,768.7344 Q1028.1563,768.7344 1026.8281,767.0938 Q1025.5156,765.4375 1025.5156,762.3125 Q1025.5156,759.1875 1026.8281,757.5313 Q1028.1563,755.875 1030.6563,755.875 Q1031.3594,755.875 1032,756.0313 Q1032.6563,756.1875 1033.2188,756.4844 L1033.2188,759.2031 Q1032.5938,758.625 1032,758.3594 Q1031.4063,758.0781 1030.7813,758.0781 Q1029.4375,758.0781 1028.75,759.1563 Q1028.0625,760.2188 1028.0625,762.3125 Q1028.0625,764.4063 1028.75,765.4844 Q1029.4375,766.5469 1030.7813,766.5469 Q1031.4063,766.5469 1032,766.2813 Q1032.5938,766 1033.2188,765.4219 L1033.2188,768.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="1050.75" y="766.6543">Message</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="964.5" x2="1160.5" y1="778.5" y2="778.5"/><ellipse cx="974.5" cy="789.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="983.5" y="792.7104">int Id {get;set;}</text><ellipse cx="974.5" cy="802.3047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="983.5" y="805.5151">String Content {get;set;}</text><ellipse cx="974.5" cy="815.1094" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="983.5" y="818.3198">DateTime SentDate {get;set;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="964.5" x2="1160.5" y1="824.9141" y2="824.9141"/><!--MD5=[3a668eb3a1ab23e10f3209ae5591cdc8]
class ResponseContext--><rect codeLine="71" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="163.2422" id="ResponseContext" style="stroke: #A80036; stroke-width: 1.5;" width="598" x="1126.5" y="931"/><ellipse cx="1366.25" cy="947" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1369.2188,952.6406 Q1368.6406,952.9375 1368,953.0781 Q1367.3594,953.2344 1366.6563,953.2344 Q1364.1563,953.2344 1362.8281,951.5938 Q1361.5156,949.9375 1361.5156,946.8125 Q1361.5156,943.6875 1362.8281,942.0313 Q1364.1563,940.375 1366.6563,940.375 Q1367.3594,940.375 1368,940.5313 Q1368.6563,940.6875 1369.2188,940.9844 L1369.2188,943.7031 Q1368.5938,943.125 1368,942.8594 Q1367.4063,942.5781 1366.7813,942.5781 Q1365.4375,942.5781 1364.75,943.6563 Q1364.0625,944.7188 1364.0625,946.8125 Q1364.0625,948.9063 1364.75,949.9844 Q1365.4375,951.0469 1366.7813,951.0469 Q1367.4063,951.0469 1368,950.7813 Q1368.5938,950.5 1369.2188,949.9219 L1369.2188,952.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="110" x="1386.75" y="951.1543">ResponseContext</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1127.5" x2="1723.5" y1="963" y2="963"/><ellipse cx="1137.5" cy="974" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="1146.5" y="977.2104">String HTTPVersion {get;set;}</text><ellipse cx="1137.5" cy="986.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="184" x="1146.5" y="990.0151">String StatusMessage {get;set}</text><ellipse cx="1137.5" cy="999.6094" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="142" x="1146.5" y="1002.8198">int StatusCode {get;set}</text><ellipse cx="1137.5" cy="1012.4141" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="303" x="1146.5" y="1015.6245">List&lt;HttpHeaderPair&gt; HeaderPairs {get;private set;}</text><ellipse cx="1137.5" cy="1025.2188" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="1146.5" y="1028.4292">String Content {get;set;}</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1127.5" x2="1723.5" y1="1035.0234" y2="1035.0234"/><ellipse cx="1137.5" cy="1046.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="572" x="1146.5" y="1049.2339">static ResponseContext ResponseContext(String httpVersion, String statusMessage, int statusCode)</text><ellipse cx="1137.5" cy="1058.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="272" x="1146.5" y="1062.0386">void AddHeader(HttpHeaderPair httpHeaderPair)</text><ellipse cx="1137.5" cy="1071.6328" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="1146.5" y="1074.8433">override string ToString()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1134.5" y="1081.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="434" x="1146.5" y="1087.6479">ResponseContext(String httpVersion, String statusMessage, int statusCode)</text><!--MD5=[bc1795c787dc82a8b7444b2d40c8c2ac]
class HTTPResponseHandler--><rect codeLine="84" fill="#FEFECE" filter="url(#f14cyf4wa1gl9m)" height="86.4141" id="HTTPResponseHandler" style="stroke: #A80036; stroke-width: 1.5;" width="458" x="1196.5" y="746.5"/><ellipse cx="1350.25" cy="762.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1353.2188,768.1406 Q1352.6406,768.4375 1352,768.5781 Q1351.3594,768.7344 1350.6563,768.7344 Q1348.1563,768.7344 1346.8281,767.0938 Q1345.5156,765.4375 1345.5156,762.3125 Q1345.5156,759.1875 1346.8281,757.5313 Q1348.1563,755.875 1350.6563,755.875 Q1351.3594,755.875 1352,756.0313 Q1352.6563,756.1875 1353.2188,756.4844 L1353.2188,759.2031 Q1352.5938,758.625 1352,758.3594 Q1351.4063,758.0781 1350.7813,758.0781 Q1349.4375,758.0781 1348.75,759.1563 Q1348.0625,760.2188 1348.0625,762.3125 Q1348.0625,764.4063 1348.75,765.4844 Q1349.4375,766.5469 1350.7813,766.5469 Q1351.4063,766.5469 1352,766.2813 Q1352.5938,766 1353.2188,765.4219 L1353.2188,768.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="1370.75" y="766.6543">HTTPResponseHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1197.5" x2="1653.5" y1="778.5" y2="778.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1197.5" x2="1653.5" y1="786.5" y2="786.5"/><ellipse cx="1207.5" cy="797.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="374" x="1216.5" y="800.7104">void OKResponse(NetworkStream networkStream, String content)</text><ellipse cx="1207.5" cy="810.3047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="403" x="1216.5" y="813.5151">void CreatedResponse(NetworkStream networkStream, String content)</text><ellipse cx="1207.5" cy="823.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="432" x="1216.5" y="826.3198">void UnauthorizedResponse(NetworkStream networkStream, String content)</text><!--MD5=[4547ca20b6e363e1d9c20ec634317bbc]
reverse link IHTTPServer to BaseHTTPServer--><path d="M1049.5,88.1 C1049.5,100.51 1049.5,114.19 1049.5,127.84 " fill="none" id="IHTTPServer-backto-BaseHTTPServer" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="1042.5,88.04,1049.5,68.04,1056.5,88.04,1042.5,88.04" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[3e8e5333cc1f6f5285b74f077d4b07ef]
reverse link IResourceEndpointHandler to MessageResourceEndpointHandler--><path d="M994.92,470.62 C972.4,491.09 946.21,514.9 923.09,535.92 " fill="none" id="IResourceEndpointHandler-backto-MessageResourceEndpointHandler" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="990.33,465.33,1009.84,457.05,999.75,475.69,990.33,465.33" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[1236eef9ffa8c5663deea225b02b3683]
reverse link ICRUDHandler to MessageResourceEndpointHandler--><path d="M751.08,489.71 C767.94,505.03 785.6,521.09 801.77,535.79 " fill="none" id="ICRUDHandler-backto-MessageResourceEndpointHandler" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="none" points="746.3,494.83,736.21,476.19,755.72,484.47,746.3,494.83" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[04f741812c7d3cb5e15f7a8510103012]
reverse link BaseHTTPServer to IResourceEndpointHandler--><path codeLine="95" d="M1049.5,317.17 C1049.5,340.7 1049.5,364.29 1049.5,382.83 " fill="none" id="BaseHTTPServer-backto-IResourceEndpointHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1049.5,304.13,1045.5,310.13,1049.5,316.13,1053.5,310.13,1049.5,304.13" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[6d7392f12eafbe2260d97222f7c6417c]
reverse link RequestContext to HttpHeaderPair--><path codeLine="96" d="M185.5,884.34 C185.5,911.35 185.5,939.72 185.5,962.79 " fill="none" id="RequestContext-backto-HttpHeaderPair" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="185.5,871.22,181.5,877.22,185.5,883.22,189.5,877.22,185.5,871.22" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[175ed4795a2e9e9de08f056caf170d19]
reverse link MessageResourceEndpointHandler to RouteAction--><path codeLine="97" d="M796.81,657.54 C769.55,684.31 738.45,714.87 713.15,739.72 " fill="none" id="MessageResourceEndpointHandler-backto-RouteAction" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="806.27,648.24,799.1871,649.5937,797.7125,656.6525,804.7954,655.2987,806.27,648.24" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[0e7b84372203ec7517524bee1a5448e7]
reverse link MessageResourceEndpointHandler to Message--><path codeLine="98" d="M928.54,657.56 C958.45,686.8 992.97,720.53 1019.47,746.43 " fill="none" id="MessageResourceEndpointHandler-backto-Message" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="919.01,648.24,920.5065,655.2941,927.5936,656.6258,926.0971,649.5717,919.01,648.24" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[eb405448917d2ccc53c7100f02facd9e]
reverse link MessageResourceEndpointHandler to HTTPResponseHandler--><path codeLine="99" d="M1033.69,652.44 C1121.04,682.78 1225.23,718.96 1304.2,746.38 " fill="none" id="MessageResourceEndpointHandler-backto-HTTPResponseHandler" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1021.2,648.11,1025.5596,653.854,1032.5386,652.0389,1028.1789,646.2949,1021.2,648.11" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[4571fffde37a400a71638b9888339430]
link HTTPResponseHandler to ResponseContext--><path codeLine="101" d="M1425.5,832.59 C1425.5,858.86 1425.5,893.64 1425.5,925.54 " fill="none" id="HTTPResponseHandler-to-ResponseContext" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1425.5,930.64,1429.5,921.64,1425.5,925.64,1421.5,921.64,1425.5,930.64" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[2caa162dff524aa20b7114cecef18e15]
link MessageResourceEndpointHandler to RequestContext--><path codeLine="102" d="M657.83,634.57 C571.68,653.97 470.87,679.16 381.5,708 C377.41,709.32 373.29,710.69 369.14,712.09 " fill="none" id="MessageResourceEndpointHandler-to-RequestContext" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="364.26,713.76,374.0697,714.6378,368.9919,712.1446,371.485,707.0668,364.26,713.76" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[451bc6122afd9a20e60b628696604c27]
@startuml
class BaseHTTPServer implements IHTTPServer{
    + const string VERSION
    + const string NAME
    - int port
    - bool running
    - TcpListener listener
    - List<IResourceEndpointHandler> resourceEndpointHandlers

    + BaseHTTPServer(int port)
    + void Start()
    - void Run()
    - void HandleClient(TcpClient client)
}

class RequestContext{
    + String Type {get;set;}
    + String URL {get;set;}
    + String HTTPVersion {get;set;}
    + List<HttpHeaderPair> HeaderPairs {get;private set;}
    + String Body {get;set;}

    + void AddHeader(String headerLine)
    + static RequestContext GetBaseRequest(String request)
    + override string ToString()
    - RequestContext(String type, String url, String httpVersion)
}

class HttpHeaderPair{
    + String HeaderKey {get;set;}
    + String HeaderValue {get;set;}

    + HttpHeaderPair(String headerKey, String headerValue)
    + override string ToString()
}

interface IResourceEndpointHandler{
    + bool CheckResponsibility(RequestContext requestContext)
    + void HandleRequest(RequestContext requestContext)
}

interface ICRUDHandler{
    + void ListHandler(RequestContext requestContext)
    + void CreateHandler(RequestContext requestContext)
    + void ReadHandler(RequestContext requestContext)
    + void UpdateHandler(RequestContext requestContext)
    + void DeleteHandler(RequestContext requestContext)
}

class MessageResourceEndpointHandler implements IResourceEndpointHandler, ICRUDHandler{
    - List<Message> messages
    - const String urlBase
    - List<RouteAction> RouteActions

    + MessageResourceEndpointHandler()
    - RouteAction DetermineRouteAction(RequestContext requestContext)
}
 class RouteAction{
     + String PathRegex {get;set;}
     + Action<RequestContext> PathAction {get;set;}
     + String RequestType {get;set;}

     + RouteAction(IAction<RequestContext> pathAction, String pathRegex, String requestType)
 }

 class Message{
     + int Id {get;set;}
     + String Content {get;set;}
     + DateTime SentDate {get;set;}
 }

class ResponseContext{
    + String HTTPVersion {get;set;}
    + String StatusMessage {get;set}
    + int StatusCode {get;set}
    + List<HttpHeaderPair> HeaderPairs {get;private set;}
    + String Content {get;set;}

    + static ResponseContext ResponseContext(String httpVersion, String statusMessage, int statusCode)
    + void AddHeader(HttpHeaderPair httpHeaderPair)
    + override string ToString()
    - ResponseContext(String httpVersion, String statusMessage, int statusCode)
}

class HTTPResponseHandler{
    + void OKResponse(NetworkStream networkStream, String content)
    + void CreatedResponse(NetworkStream networkStream, String content)
    + void UnauthorizedResponse(NetworkStream networkStream, String content)
}

interface IHTTPServer{
    + void Start()
}


 BaseHTTPServer o- - IResourceEndpointHandler
 RequestContext o- - HttpHeaderPair
 MessageResourceEndpointHandler o- - RouteAction
 MessageResourceEndpointHandler o- -Message
MessageResourceEndpointHandler o- - HTTPResponseHandler

HTTPResponseHandler..>ResponseContext
 MessageResourceEndpointHandler ..> RequestContext
@enduml

PlantUML version 1.2020.18(Wed Sep 30 21:40:44 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>